"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var DR=function(){function DR(canvas,v,f){this.canvas=canvas,this.header="#version 300 es\n        #ifdef GL_ES\n                precision highp float;\n                precision highp int;\n                precision mediump sampler3D;\n        #endif\n        ",this.targets=new Map,this.programs=new Map,this.textureCache=new Map,this.gl=canvas.getContext("webgl2",{preserveDrawingBuffer:!0});var gl=this.gl,c=0,d;for(var i in gl)"function"==typeof gl[i]&&(gl[d=(d=(255&c++).toString(16)).match(/^[0-9].*$/)?"x"+d:d]=gl[i]);gl.df(0,0,canvas.width,canvas.height),this.buffer=gl.x71(),this.surfaceBuffer=gl.x71(),this.mainProgram=gl.x73(),this.cS(this.mainProgram,35633,this.header+v),this.cS(this.mainProgram,35632,this.header+f),gl.af(this.mainProgram),gl.d4(this.mainProgram),this.screenVertexPosition=gl.x91(this.mainProgram,"pos"),gl.x87(this.screenVertexPosition),gl.x5b(34962,this.buffer),gl.x64(34962,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),35044)}return DR.prototype.cS=function(program,type,source){var gl=this.gl,shader=gl.x75(type);gl.b6(shader,source),gl.x6c(shader),gl.x59(program,shader)},DR.prototype.aP=function(name){var p=this.gl.x73();return this.programs.set(name,p),p},DR.prototype.t=function(image){var gl=this.gl,texture=gl.x76();return gl.x5e(3553,texture),gl.bf(3553,0,6408,6408,5121,image),gl.x8d(3553),texture},DR.prototype.aA=function(textures,cb){var _this=this,c=Object.keys(textures).length;Object.keys(textures).forEach((function(key){var m=new Image;m.onload=function(e){_this.textureCache.set(key,_this.t(m)),_this.textureCache.size===c&&cb()},m.src=textures[key].src}))},DR.prototype.aB=function(name,vertex,fragment,textures){var _this=this,gl=this.gl,target=this.cT(this.canvas.width,this.canvas.height,textures||[]);this.targets.set(name,target);var program=this.aP(name);return this.cS(program,35633,this.header+vertex),this.cS(program,35632,this.header+fragment),gl.af(program),gl.d4(program),textures&&textures.forEach((function(tk){var m=_this.textureCache.get(tk);gl.x5e(3553,m)})),this.vertexPosition=gl.x91(program,"pos"),gl.x87(this.vertexPosition),this},DR.prototype.R=function(time){var _this=this,gl=this.gl,main=this.mainProgram,i=0;this.programs.forEach((function(current,key){gl.d4(current);var target=_this.targets.get(key);gl.c5(gl.a2(current,"resolution"),_this.canvas.width,_this.canvas.height),gl.c1(gl.a2(current,"time"),time),target.textures.forEach((function(tk){var loc=gl.a2(current,tk);gl.x58(33984+i),gl.c3(loc,i),i++})),gl.x5b(34962,_this.surfaceBuffer),gl.de(0,2,5126,!1,0,0),gl.x5b(34962,_this.buffer),gl.de(0,2,5126,!1,0,0),gl.x5c(36160,target.framebuffer),gl.x67(16640),gl.x84(4,0,6)})),gl.d4(main),gl.c5(gl.a2(main,"resolution"),this.canvas.width,this.canvas.height),gl.c1(gl.a2(main,"time"),time),gl.x5b(34962,this.buffer),gl.de(0,2,5126,!1,0,0),this.targets.forEach((function(target,key){gl.c3(gl.a2(main,key),i),gl.x58(33984+i),gl.x5e(3553,target.texture),i++})),gl.x5c(36160,null),gl.x67(16640),gl.x84(4,0,6)},DR.prototype.cT=function(width,height,textures){var gl=this.gl,t={framebuffer:gl.x72(),renderbuffer:gl.x74(),texture:gl.x76(),textures:textures};return gl.x5e(3553,t.texture),gl.bf(3553,0,6408,width,height,0,6408,5121,null),gl.be(3553,10242,33071),gl.be(3553,10243,33071),gl.be(3553,10240,9728),gl.be(3553,10241,9728),gl.x5c(36160,t.framebuffer),gl.x8b(36160,36064,3553,t.texture,0),gl.x5d(36161,t.renderbuffer),gl.b3(36161,33189,width,height),gl.x8a(36160,36096,36161,t.renderbuffer),gl.x5e(3553,null),gl.x5d(36161,null),gl.x5c(36160,null),t},DR.prototype.run=function(t){var _this=this,fps=60,pt=performance.now(),interval=1e3/60,dt=0,a=function(t){requestAnimationFrame(a),(dt=t-pt)>1e3/60&&(pt=t-dt%(1e3/60),_this.R(pt/1e3))};return a(0|t),this},DR}();exports.DR=DR;